# vim: ft=tmux

# Initialize task repository variable (default to dotfiles)
set-environment -g TMUX_PARENT_NOTES_DIR "/home/marcos/Documents/Areas/Obsidian/"
if -F '#{==:#{TMUX_TASK_REPO_NAME},}' 'set-environment -g TMUX_TASK_REPO_NAME personal'

set-environment -g TMUX_TASKS_IN_PROGRESS_SCRIPT "$HOME/.local/scripts/tmux-tasks-in-progress \"$TMUX_PARENT_NOTES_DIR$TMUX_TASK_REPO_NAME\" \"$TMUX_TASK_REPO_NAME\""

# Command to toggle between repositories
bind-key t run-shell '
    if [ "$TMUX_TASK_REPO_NAME" = "work" ]; then
        tmux set-environment -g TMUX_TASK_REPO_NAME "personal"
        tmux display-message "Switched to personal repo for task tracking"
    else
        tmux set-environment -g TMUX_TASK_REPO_NAME "work"
        tmux display-message "Switched to work repo for task tracking"
    fi
    tmux source-file ~/.config/tmux/tmux.conf
    tmux refresh-client -S
'

# Command to show all progress tasks in a new window
bind-key y display-popup -E -w 80% -h 60% -T "Progress Tasks" "~/.local/scripts/tmux-tasks-in-progress-popup '$TMUX_PARENT_NOTES_DIR' '$TMUX_TASK_REPO_NAME'"
